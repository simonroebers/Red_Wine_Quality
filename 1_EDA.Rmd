---
title: "1_EDA"
output:
  github_document:
    toc: true
    toc_depth: 2
---

# Load packages and data
```{r}
library(tidyverse)
library(skimr)
library(corrplot)
library(dagitty)
df <- read.csv('winequality-red.csv')
glimpse(df)
```

# Summary Statistics
```{r}
df |> skim()
```

- Data set is already clean
- Features are all numeric

# Create features
```{r}
df$quality_fct <- as.factor(df$quality)
```


# Correlations
```{r}
df |> select(where(is.numeric)) |> cor() |> 
  corrplot(method = "color", type = "upper", diag = FALSE, tl.cex = 0.8)
```

- Alcohol, sulphates, and citric acid appear to positively correlate with the quality
- The volatile acidity seems to have a negative correlation


# Explore some features

## Wine Quality
```{r}
ggplot() +
  geom_histogram(data = df, aes(x = quality), bins = 6, color = 'black', 
                 fill = 'white') +
theme_bw(base_size = 14)
```

- The outcome variable is very unbalanced
- Wine quality is largely 5 and 6

## Alcohol
```{r}
ggplot(df, aes(x = alcohol, fill = quality_fct)) +
  geom_density(alpha = 0.5) +
theme_bw(base_size = 14)
```

- The level of alcohol is greater with higher quality


## Volatile acidity
```{r}
ggplot(df, aes(x = quality_fct, y = volatile.acidity, fill = quality_fct)) +
  geom_violin(alpha = 0.5) +
  guides(fill="none") +
  theme_bw(base_size = 14)
```

- The aciditiy of higher quality wines is less volatile

## Sulphates
```{r}
ggplot(df, aes(x = quality_fct,  y = sulphates, color = quality_fct)) +
  geom_point(position = position_dodge2(w = 0.75)) +
  theme_bw(base_size = 14)
```

- Higher quality wine tends to have on average more sulphates

# Citric acid
```{r}
ggplot(df, aes(x = citric.acid,  y = quality_fct, color = quality_fct)) +
  geom_boxplot() +
  stat_summary(fun = "mean", geom = "point", shape = 2, size = 2, color = "black") +
  theme_bw(base_size = 14)
```

- The same seems to hold true for the citric acid

# DAG
- Correlation does not equal causation
- Similarities are assumed here for ease of application

```{r}
dag <- dagitty('
dag {
alcohol -> quality
volatile.acidity -> quality
sulphates -> quality
citric.acid -> quality
}
')
plot(graphLayout(dag))
```

